# MNIST로 생성해보는 숫자 이미지

## 실습 전 내용
생성자는 Latent space 또는 noise vector 라고 불리는 곳에서 다양성을 창출해낸다. 6장에서 Latent space에서의 차원에 따른 생성 이미지의 차이에 대해 더 다루어볼 예정이라서 간략히만 소개하고 넘어가겠습니다.

## 추가적으로 알아두면 좋은 개념
- Linear
- Convolution
- Transpose Convolution, Upsampling
- Binary Cross entropy
  
## 1.1 Generater()
이번에는 생성자 모델을 만들어볼 예정인데, 구현하기 전에 logic 설명부터 하도록 하겠습니다. 

Latent space를 직역하면, 잠재적 공간입니다. 말 그대로 이 공간 속에서는 다양성이 창출될 수 있는 곳입니다. 이 공간에는 무작위 값들이 들어오기 때문에, noise vector라고도 불립니다. 기본적으로 처음 Gan model에서 사용된 Latent space는 1차원 형태의 100개의 값으로 구성이 된 선형층입니다.

하지만 우리가 오늘 해볼 실습은 mnist라는 손글씨 숫자이미지를 생성해볼 예정이기 때문에 1차원을 이미지형태인 차원으로 변환작업을 거쳐야 합니다.

따라서 정리해보면, 생성자 모델은 (100,) 의 Latent space로부터 mnist dataset 형태의 28*28 흑백 이미지를 만들어 내는 모델입니다. 물론 28*28 이미지를 생성하기 위해서는 768개의 1차원 데이터가 필요하다는 건 알고 있다고 생각하겠습니다. 


```
class Generator(nn.Module):
  def __init__(self, latent_dim= 100, out_channels= None, img_size= 28):
    super(Generator, self).__init__()
    self.img_size = img_size//2
    mid_channels = (self.img_size * self.img_size)

    self.latent_layer = nn.Sequential(
        nn.Linear(latent_dim, mid_channels, bias= False),
        nn.BatchNorm1d(mid_channels),
        nn.LeakyReLU(0.2)
    )
    self.image_generater = nn.Sequential(
        nn.UpsamplingBilinear2d(scale_factor=2),
        nn.BatchNorm2d(1),
        nn.LeakyReLU(0.2)
    )

  def forward(self, x):
    x = self.latent_layer(x)
    x = x.view(x.size(0), -1, self.img_size, self.img_size)
    x = self.image_generater(x)
    return x
```



